<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Naam Jap Counter</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: #ffd84d;
  text-align: center;
}

header {
  background: #f5c400;
  padding: 15px;
  font-size: 22px;
  font-weight: bold;
}

button {
  padding: 12px 18px;
  margin: 10px;
  border: none;
  border-radius: 10px;
  background: #000;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}

.hidden { display: none; }

.circle {
  width: 220px;
  height: 220px;
  border-radius: 50%;
  border: 12px solid rgba(0,0,0,0.2);
  margin: 40px auto;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 42px;
  font-weight: bold;
  position: relative;
  cursor: pointer;
}

.circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 50%;
  border: 12px solid #000;
  transform: rotate(-90deg);
  stroke-dasharray: 690;
  stroke-dashoffset: var(--fill, 690);
}

.stats {
  font-size: 16px;
  margin: 8px;
}

.card {
  background: #fff3c4;
  margin: 20px;
  padding: 15px;
  border-radius: 12px;
}
</style>
</head>

<body>

<header id="title">RADHARAMAN</header>

<!-- HOME -->
<div id="home">
  <h2>Select Jap Counter</h2>
  <button onclick="openCounter('radha')">Radha</button>
  <button onclick="openCounter('mahadev')">Mahadev</button>
  <button onclick="openCounter('ram')">Ram</button>
</div>

<!-- COUNTER -->
<div id="counter" class="hidden">

  <button onclick="goHome()">â¬… Back</button>

  <h1 id="godName"></h1>

  <div class="circle" onclick="tap()" id="circle">
    <span id="count">0</span>
  </div>

  <div class="stats" id="today"></div>
  <div class="stats" id="week"></div>
  <div class="stats" id="month"></div>

  <div class="card">
    <strong>Most Active Time</strong>
    <div id="activeTime"></div>
  </div>

</div>

<script>
let currentGod = "";

function openCounter(god) {
  currentGod = god;
  document.getElementById("home").classList.add("hidden");
  document.getElementById("counter").classList.remove("hidden");
  document.getElementById("godName").innerText = god.toUpperCase();
  loadData();
}

function goHome() {
  document.getElementById("counter").classList.add("hidden");
  document.getElementById("home").classList.remove("hidden");
}

function getKey(key) {
  return `${currentGod}_${key}`;
}

function tap() {
  let total = parseInt(localStorage.getItem(getKey("total")) || 0);
  total++;
  localStorage.setItem(getKey("total"), total);

  let todayKey = new Date().toDateString();
  let today = JSON.parse(localStorage.getItem(getKey("today")) || "{}");
  today[todayKey] = (today[todayKey] || 0) + 1;
  localStorage.setItem(getKey("today"), JSON.stringify(today));

  let hour = new Date().getHours();
  let hours = JSON.parse(localStorage.getItem(getKey("hours")) || "{}");
  hours[hour] = (hours[hour] || 0) + 1;
  localStorage.setItem(getKey("hours"), JSON.stringify(hours));

  updateUI();
}

function loadData() {
  updateUI();
}

function updateUI() {
  let total = localStorage.getItem(getKey("total")) || 0;
  document.getElementById("count").innerText = total;

  let todayData = JSON.parse(localStorage.getItem(getKey("today")) || "{}");
  let todayKey = new Date().toDateString();
  document.getElementById("today").innerText =
    "Today's Taps: " + (todayData[todayKey] || 0);

  let weekTotal = 0;
  let now = new Date();
  for (let k in todayData) {
    let d = new Date(k);
    if ((now - d) / (1000 * 60 * 60 * 24) <= 7) {
      weekTotal += todayData[k];
    }
  }

  document.getElementById("week").innerText =
    "This Week: " + weekTotal;

  let monthTotal = 0;
  for (let k in todayData) {
    let d = new Date(k);
    if (d.getMonth() === now.getMonth() && d.getFullYear() === now.getFullYear()) {
      monthTotal += todayData[k];
    }
  }

  document.getElementById("month").innerText =
    "This Month: " + monthTotal;

  let hours = JSON.parse(localStorage.getItem(getKey("hours")) || "{}");
  let maxHour = "N/A", max = 0;
  for (let h in hours) {
    if (hours[h] > max) {
      max = hours[h];
      maxHour = h + ":00 - " + (parseInt(h)+1) + ":00";
    }
  }

  document.getElementById("activeTime").innerText = maxHour;

  let fill = 690 - (total % 108) / 108 * 690;
  document.getElementById("circle").style.setProperty("--fill", fill);
}
</script>

</body>
</html>
